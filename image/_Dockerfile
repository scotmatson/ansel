FROM node:8.11.2-stretch

MAINTAINER Scot Matson <sjpmatson@gmail.com>

RUN apt-get update && apt-get upgrade -y

RUN apt-get install -y --no-install-recommends \
  curl \
  ffmpeg \
  gnupg \
  imagemagick \
  unoconv \
  libatk-bridge2.0-0 \
  libgtk-3-0

RUN mkdir -p /usr/src/app
WORKDIR /usr/src/app

COPY package*.json /usr/src/app/
RUN npm install

COPY . /usr/src/app/

USER node

EXPOSE 3000 443 80
CMD [ "npm", "start" ]
